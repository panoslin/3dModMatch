{% extends 'base.html' %}
{% load static %}

{% block title %}首页 - 3D鞋模匹配系统{% endblock %}

{% block extra_css %}
<style>
.hero-section {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 80px 0;
}

.feature-card {
    transition: transform 0.3s ease;
    height: 100%;
}

.feature-card:hover {
    transform: translateY(-5px);
}

.stats-card {
    background: linear-gradient(45deg, #f8f9fa, #e9ecef);
    border-left: 4px solid #007bff;
}

.btn-primary-custom {
    background: linear-gradient(45deg, #007bff, #0056b3);
    border: none;
    padding: 12px 30px;
    font-weight: bold;
    border-radius: 25px;
}
</style>
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section">
    <div class="container text-center">
        <h1 class="display-4 font-weight-bold mb-4">🦶 智能3D鞋模匹配系统</h1>
        <p class="lead mb-5">
            运用先进的3D几何分析技术，为您的鞋模找到最优的粗胚匹配方案<br>
            节省材料成本，提升生产效率
        </p>
        <div class="row justify-content-center">
            <div class="col-auto">
                <a href="{% url 'core:upload' %}" class="btn btn-primary-custom btn-lg mr-3">
                    📁 开始上传文件
                </a>
            </div>
            <div class="col-auto">
                <a href="{% url 'core:matching' %}" class="btn btn-outline-light btn-lg">
                    🎯 立即匹配分析
                </a>
            </div>
        </div>
    </div>
</section>

<!-- 统计概览 -->
<section class="py-5">
    <div class="container">
        <div class="row">
            <div class="col-md-3 mb-4">
                <div class="card stats-card h-100">
                    <div class="card-body text-center">
                        <h2 class="text-primary">{{ shoe_models_count }}</h2>
                        <p class="mb-0">鞋模文件</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-4">
                <div class="card stats-card h-100">
                    <div class="card-body text-center">
                        <h2 class="text-success">{{ blank_models_count }}</h2>
                        <p class="mb-0">粗胚文件</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-4">
                <div class="card stats-card h-100">
                    <div class="card-body text-center">
                        <h2 class="text-info">{{ total_matches }}</h2>
                        <p class="mb-0">匹配结果</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-4">
                <div class="card stats-card h-100">
                    <div class="card-body text-center">
                        <h2 class="text-warning">
                            {% if recent_results %}{{ recent_results|length }}{% else %}0{% endif %}
                        </h2>
                        <p class="mb-0">最优方案</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- 功能特色 -->
<section class="py-5 bg-light">
    <div class="container">
        <div class="row text-center mb-5">
            <div class="col-12">
                <h2 class="font-weight-bold">🌟 系统特色</h2>
                <p class="text-muted">先进技术，精准匹配</p>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-4 mb-4">
                <div class="card feature-card shadow-sm">
                    <div class="card-body text-center">
                        <div class="text-primary mb-3">
                            <i class="fas fa-cube" style="font-size: 3rem;"></i>
                        </div>
                        <h5 class="card-title">3D几何分析</h5>
                        <p class="card-text text-muted">
                            深度分析3D模型的几何特征，包括曲率分析、体积计算、形状匹配等
                        </p>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4 mb-4">
                <div class="card feature-card shadow-sm">
                    <div class="card-body text-center">
                        <div class="text-success mb-3">
                            <i class="fas fa-chart-line" style="font-size: 3rem;"></i>
                        </div>
                        <h5 class="card-title">智能优化</h5>
                        <p class="card-text text-muted">
                            自动寻找最优匹配方案，最大化材料利用率，最小化生产成本
                        </p>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4 mb-4">
                <div class="card feature-card shadow-sm">
                    <div class="card-body text-center">
                        <div class="text-info mb-3">
                            <i class="fas fa-eye" style="font-size: 3rem;"></i>
                        </div>
                        <h5 class="card-title">可视化展示</h5>
                        <p class="card-text text-muted">
                            直观的3D可视化界面，清晰展示匹配结果和重合度分析
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- 最近匹配结果 -->
{% if recent_results %}
<section class="py-5">
    <div class="container">
        <div class="row mb-4">
            <div class="col-12">
                <h3 class="font-weight-bold">🎯 最近匹配结果</h3>
                <p class="text-muted">最新的优化匹配方案</p>
            </div>
        </div>
        
        <div class="row">
            {% for result in recent_results %}
            <div class="col-md-6 mb-4">
                <div class="card">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-3">
                            <h6 class="card-title mb-0">
                                {{ result.shoe_model.filename }}
                            </h6>
                            <span class="badge badge-success">最优</span>
                        </div>
                        
                        <p class="text-muted small mb-2">
                            <strong>匹配粗胚:</strong> {{ result.blank_model.filename }}
                        </p>
                        
                        <div class="row text-center">
                            <div class="col-6">
                                <small class="text-muted">材料利用率</small>
                                <div class="font-weight-bold text-primary">
                                    {{ result.material_utilization|floatformat:1 }}%
                                </div>
                            </div>
                            <div class="col-6">
                                <small class="text-muted">平均余量</small>
                                <div class="font-weight-bold text-success">
                                    {{ result.average_margin|floatformat:1 }}mm
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-3">
                            <a href="{% url 'core:matching_results' result.id %}" 
                               class="btn btn-outline-primary btn-sm">
                                查看详情
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <div class="text-center">
            <a href="{% url 'core:matching' %}" class="btn btn-outline-secondary">
                查看所有结果 →
            </a>
        </div>
    </div>
</section>
{% endif %}

<!-- 快速开始 -->
<section class="py-5 bg-primary text-white">
    <div class="container text-center">
        <h3 class="mb-4">🚀 准备开始？</h3>
        <p class="lead mb-4">
            上传您的鞋模和粗胚文件，让我们的智能系统为您找到最优匹配方案
        </p>
        <a href="{% url 'core:upload' %}" class="btn btn-light btn-lg">
            立即开始 →
        </a>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<!-- Font Awesome -->
<script src="https://kit.fontawesome.com/your-font-awesome-kit.js" crossorigin="anonymous"></script>
{% endblock %}